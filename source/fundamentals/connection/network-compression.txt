.. _node-network-compression:

===================
Network Compression
===================

You can enable a driver option to compress messages, which reduces the amount
of data passed over the network between MongoDB and your application.

The driver supports the following compression algorithms:

1. `Snappy <https://google.github.io/snappy/>`__: available in MongoDB 3.6 and later.

2. `Zlib <https://zlib.net/>`__: available in MongoDB 3.6 and later.

If you specify multiple compression algorithms, the driver selects the
first one in the list supported by your MongoDB instance.

.. _enable-compression:

Specify Compression Algorithms
------------------------------

To enable compression for the connection to your MongoDB instance, use one of 
the following methods to specify the algorithms:

1. Add the parameter to the connection string. 
2. Specify the ``compressors`` option in your ``MongoClientOptions``.

Select the tab that matches your use case for instructions on how to specify
the compression algorithm:

.. tabs::

   .. tab:: Connection String
      :tabid: connection-string

      To enable compression by using parameters on the connection string, add 
      the ``compressors`` parameter and the names of the algorithms as the
      value. You can specify one or more compression algorithms, separating 
      them with commas:

      .. code-block:: javascript
         :emphasize-lines: 2

         const uri =
           "mongodb+srv://<user>:<password>@<cluster-url>/?compressors=snappy,zlib";

         const client = new MongoClient(uri);

   .. tab:: MongoClientOptions
      :tabid: mongoclientoptions

      To enable compression by using `MongoClientOptions <{+api+}/api/global.html#MongoClientOptions>`__,
      pass the ``compressors`` option and the names of compression algorithms
      that you want to use. You can specify one or more compression
      algorithms, separating them with commas:

      .. code-block:: javascript
         :emphasize-lines: 6

         const uri =
           "mongodb+srv://<user>:<password>@<cluster-url>";

         const client = new MongoClient(uri,
           {
             compressors: ["snappy", "zlib"]
           });

Specify compression algorithms by using the following strings:

- "snappy" for `Snappy <https://google.github.io/snappy/>`__ compression
- "zlib" for `Zlib <https://zlib.net/>`__ compression

.. _compression-dependencies:

Compression Algorithm Dependencies
----------------------------------

To use Snappy compression, add it to your application dependencies by
running the following command:

.. code-block:: javascript

   npm install --save snappy

You can use Zlib compression without adding any additional dependencies.

