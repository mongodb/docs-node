.. _node-whats-new:

==========
What's New
==========

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

.. facet::
   :name: genre
   :values: reference
 
.. meta::
   :keywords: version, update, upgrade, backwards compatibility


Learn what's new in:

* :ref:`Version 6.1 <version-6.1>`
* :ref:`Version 6.0 <version-6.0>`

.. _version-6.1:

What's New in 6.1
-----------------

The {+driver-short+} v6.1 release includes the following features:

- Updates the ``bson`` package version to 6.1.0 to expose the
  ``Decimal128.fromStringWithRounding()`` method. To learn more, see the
  `v6.1.0 bson release notes <https://github.com/mongodb/js-bson/releases/tag/v6.1.0>`__.

- Detects environment variables for region settings when
  authenticating by using the ``MONGODB-AWS`` authentication mechanism.
  To instruct the driver to use your region options, you must set both
  of the following environment variables:
  
  - ``AWS_STS_REGIONAL_ENDPOINTS``
  - ``AWS_REGION``

- Fixes a memory leak issue caused by recursive calls to the ``next()``
  method of the ``ChangeStream`` type.

To learn more about this release, see the
`v6.1.0 Release Highlights
<https://github.com/mongodb/node-mongodb-native/releases/tag/v6.1.0>`__.

.. _version-6.0:

What's New in 6.0
-----------------

.. warning:: Breaking Changes in v6.0

   This driver version introduces breaking changes. For a list of these changes, see
   the :ref:`Version 6.0 Breaking Changes section <node-breaking-changes-v6.0>` in the
   Upgrade guide.

The {+driver-short+} v6.0 release includes the following features:

.. important:: Deprecation Notice

   All of the ``ssl``-prefixed options in the ``MongoClientOptions``
   type are deprecated. In addition, the ``tlsCertificateFile`` option
   is deprecated.

   Instead, you should store your certificates in a ``SecureContext``
   object or set the ``tls``-prefixed options in your
   ``MongoClientOptions`` instance. To learn more, see :ref:`node-connect-tls`.

- Removal of support for the ``addUser()`` helper command. Use the
  :manual:`createUser </reference/command/createUser>` MongoDB Shell command instead.

- Removal of support for the ``collStats`` operation. Use the
  :manual:`$collStats </reference/operator/aggregation/collStats>` aggregation operator
  instead.

- The ``options`` field of the ``ConnectionPoolCreatedEvent`` type
  contains only the following fields, which are the non-default pool
  options:

  - ``maxConnecting``
  - ``maxPoolSize``
  - ``minPoolSize``
  - ``maxIdleTimeMS``
  - ``waitQueueTimeoutMS``

- The driver asynchronously reads files set in the ``tlsCAFile`` and
  ``tlsCertificateKeyFile`` connection options when you call
  the ``MongoClient.connect()`` method, not when you create a
  ``MongoClient`` instance.

- Removal of the ``keepAlive`` and ``keepAliveInitialDelay`` connection
  options. The value of ``keepAlive`` is permanently set to ``true`` and the
  value of ``keepAliveInitialDelay`` is set to 300000 milliseconds (300
  seconds).
  
  To learn how to set keepalive settings at a system level,
  see the :manual:`Does TCP keepalive time affect MongoDB Deployments? </faq/diagnostics/#does-tcp-keepalive-time-affect-mongodb-deployments->`
  FAQ entry in the Server manual.

- Removes the following options for the ``Db.command()`` method:
  
  - ``willRetryWrite``
  - ``omitReadPreference``
  - ``writeConcern``
  - ``explain``
  - ``readConcern``
  - ``collation``
  - ``maxTimeMS``
  - ``comment``
  - ``retryWrites``
  - ``dbName``
  - ``authdb``
  - ``noResponse``

  Although you cannot pass these options to the
  ``Db.command()`` method, you can still set them in the command
  document. To learn more, see the :ref:`Command Options
  <node-command-options>` section of the Run a Command guide.

To learn more about this release, see the
`v6.0.0 Release Highlights <https://github.com/mongodb/node-mongodb-native/releases/tag/v6.0.0>`__.